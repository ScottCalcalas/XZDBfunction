% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/input.R
\name{xiaopei.input}
\alias{xiaopei.input}
\title{Build an index file for one dataset}
\usage{
xiaopei.input(
  file.Name,
  Sheet = 1,
  xlsx.index.location = "Datasets infomation.xlsx",
  write_to_shinyapp = TRUE
)
}
\arguments{
\item{file.Name}{Character. Dataset filename (must exist under \verb{datasets/}).}

\item{Sheet}{Integer or character. Sheet number or sheet name when reading XLSX files.
Default: \code{1}.}

\item{xlsx.index.location}{Character. Path to the Dataset Information Excel file
(typically \code{"Datasets infomation.xlsx"}).
Must exist in the \strong{current working directory}, not inside the package.}

\item{write_to_shinyapp}{Logical. Whether to write the index output into the package \verb{shinyapp/}
directory in addition to the local \verb{IndexedData/} directory.
Default: \code{TRUE}.}
}
\value{
Invisibly returns the \code{tibble} containing the processed index table.
Primarily called for its side-effects (CSV file creation).
}
\description{
Reads a single dataset file located in the local \verb{datasets/} folder,
extracts gene identifier and gene symbol columns, normalizes and resolves
missing values, removes rows with no usable identifiers, and produces an
index file.

The resulting index CSV is written to both locations:
\enumerate{
\item Local: \verb{./IndexedData/}
\item Package: \verb{system.file("shinyapp", package = "XZDBfunction")/IndexedData/}
}

If writing to the installed package directory is not permitted,
the function writes locally without error and emits a warning.
}
\details{
The function uses the metadata in the index Excel file to:
\itemize{
\item Determine the expected file type (CSV/TXT/XLSX)
\item Locate gene identifier and gene symbol columns
\item Normalize, trim, and resolve missing identifier pairs
\item Construct stable row keys of the form \code{"DatasetName~Sheet.index"}
\item Drop rows where both ID and Symbol cannot be recovered
}
}
\examples{
\dontrun{
xiaopei.input("DatasetA.xlsx", Sheet = 1)
}

}
